
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>losoto.operations package &#8212; LoSoTo 2.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="losoto package" href="losoto.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="losoto.html" title="losoto package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="losoto.html">LoSoTo 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="losoto-operations-package">
<h1>losoto.operations package<a class="headerlink" href="#losoto-operations-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-losoto.operations.abs">
<span id="losoto-operations-abs-module"></span><h2>losoto.operations.abs module<a class="headerlink" href="#module-losoto.operations.abs" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.abs.run_parser">
<code class="descclassname">losoto.operations.abs.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.abs.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.abs.run">
<code class="descclassname">losoto.operations.abs.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.abs.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Take absolute value. Needed before smooth if amplitudes are negative!
WEIGHT: no need to be weight compliant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltab</strong> : soltab obj</p>
<blockquote class="last">
<div><p>Solution table.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.clip">
<span id="losoto-operations-clip-module"></span><h2>losoto.operations.clip module<a class="headerlink" href="#module-losoto.operations.clip" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.clip.run_parser">
<code class="descclassname">losoto.operations.clip.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.clip.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.clip.run">
<code class="descclassname">losoto.operations.clip.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>axesToClip</em>, <em>clipLevel=5.0</em>, <em>log=True</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.clip.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip solutions around the median by a factor specified by the user.
WEIGHT: flag compliant, putting weights into median is tricky</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesToClip</strong> : list of str</p>
<blockquote>
<div><p>axes along which to calculate the median</p>
</div></blockquote>
<p><strong>clipLevel</strong> : float, optional</p>
<blockquote>
<div><p>factor above/below median at which to clip, by default 5</p>
</div></blockquote>
<p><strong>log</strong> : bool, optional</p>
<blockquote class="last">
<div><p>clip is done in log10 space, by default True</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.clocktec">
<span id="losoto-operations-clocktec-module"></span><h2>losoto.operations.clocktec module<a class="headerlink" href="#module-losoto.operations.clocktec" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.clocktec.run_parser">
<code class="descclassname">losoto.operations.clocktec.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.clocktec.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.clocktec.run">
<code class="descclassname">losoto.operations.clocktec.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>flagBadChannels=True</em>, <em>flagCut=5.0</em>, <em>chi2cut=3000.0</em>, <em>combinePol=False</em>, <em>removePhaseWraps=True</em>, <em>fit3rdorder=False</em>, <em>circular=False</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.clocktec.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate phase solutions into Clock and TEC.
The Clock and TEC values are stored in the specified output soltab with type ‘clock’, ‘tec’, ‘tec3rd’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>flagBadChannels</strong> : bool, optional</p>
<blockquote>
<div><p>Detect and remove bad channel before fitting, by default True.</p>
</div></blockquote>
<p><strong>flagCut</strong> : float, optional</p>
<p><strong>chi2cut</strong> : float, optional</p>
<p><strong>combinePol</strong> : bool, optional</p>
<blockquote>
<div><p>Find a combined polarization solution, by default False.</p>
</div></blockquote>
<p><strong>removePhaseWraps</strong> : bool, optional</p>
<blockquote>
<div><p>Detect and remove phase wraps, by default True.</p>
</div></blockquote>
<p><strong>fit3rdorder</strong> : bool, optional</p>
<blockquote>
<div><p>Fit a 3rd order ionospheric ocmponent (usefult &lt;40 MHz). By default False.</p>
</div></blockquote>
<p><strong>circular</strong> : bool, optional</p>
<blockquote>
<div><p>Assume circular polarization with FR not removed. By default False.</p>
</div></blockquote>
<p><strong>reverse</strong> : bool, optional</p>
<blockquote class="last">
<div><p>Reverse the time axis. By default False.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.crossdelay">
<span id="losoto-operations-crossdelay-module"></span><h2>losoto.operations.crossdelay module<a class="headerlink" href="#module-losoto.operations.crossdelay" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.crossdelay.run_parser">
<code class="descclassname">losoto.operations.crossdelay.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.crossdelay.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.crossdelay.run">
<code class="descclassname">losoto.operations.crossdelay.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>soltabOut='phasediff'</em>, <em>maxResidual=1.0</em>, <em>smooth=0</em>, <em>replace=False</em>, <em>refAnt=''</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.crossdelay.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate cross-delay</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltabOut</strong> : str, optional</p>
<blockquote>
<div><p>output table name (same solset), by deault “phasediff”.</p>
</div></blockquote>
<p><strong>maxResidual</strong> : float, optional</p>
<blockquote>
<div><p>Maximum acceptable rms of the residuals in radians before flagging, by default 1. If 0: No check.</p>
</div></blockquote>
<p><strong>smooth</strong> : int, optional</p>
<blockquote>
<div><p>Median-smooth in time the resulting delays, number of timestamp for smoothing window. By default 0 (no smooth)</p>
</div></blockquote>
<p><strong>replace</strong> : bool, optional</p>
<blockquote>
<div><p>replace using smoothed value instead of flag bad data? Smooth must be active. By default, False</p>
</div></blockquote>
<p><strong>refAnt</strong> : str, optional</p>
<blockquote class="last">
<div><p>Reference antenna, by default the first.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.duplicate">
<span id="losoto-operations-duplicate-module"></span><h2>losoto.operations.duplicate module<a class="headerlink" href="#module-losoto.operations.duplicate" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.duplicate.run_parser">
<code class="descclassname">losoto.operations.duplicate.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.duplicate.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.duplicate.run">
<code class="descclassname">losoto.operations.duplicate.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>soltabOut=''</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.duplicate.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Duplicate a table</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltabOut</strong> : str, optional</p>
<blockquote class="last">
<div><p>Output table name. By default choose next available from table type.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.example">
<span id="losoto-operations-example-module"></span><h2>losoto.operations.example module<a class="headerlink" href="#module-losoto.operations.example" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.example.run_parser">
<code class="descclassname">losoto.operations.example.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.example.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.example.run">
<code class="descclassname">losoto.operations.example.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab, opt1, opt2=[1.0, 2.0, 3.0], opt3=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.example.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic unspecified step for easy expansion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>opt1</strong> : float</p>
<blockquote>
<div><p>Is a mandatory parameter.</p>
</div></blockquote>
<p><strong>opt2</strong> : list of float, optional</p>
<blockquote>
<div><p>Is optional, by default [1.,2.,3.]</p>
</div></blockquote>
<p><strong>opt2</strong> : int, optional</p>
<blockquote class="last">
<div><p>Is optional, by default 0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.faraday">
<span id="losoto-operations-faraday-module"></span><h2>losoto.operations.faraday module<a class="headerlink" href="#module-losoto.operations.faraday" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.faraday.run_parser">
<code class="descclassname">losoto.operations.faraday.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.faraday.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.faraday.run">
<code class="descclassname">losoto.operations.faraday.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>refAnt=''</em>, <em>maxResidual=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.faraday.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Faraday rotation extraction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>refAnt</strong> : str, optional</p>
<blockquote>
<div><p>Reference antenna, by default the first.</p>
</div></blockquote>
<p><strong>maxResidual</strong> : float, optional</p>
<blockquote class="last">
<div><p>Max average residual in radians before flagging datapoint, by default 1. If 0: no check.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.fitClockTEC">
<span id="losoto-operations-fitclocktec-module"></span><h2>losoto.operations.fitClockTEC module<a class="headerlink" href="#module-losoto.operations.fitClockTEC" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.fitClockTEC.ClockTEC_3rdorder_func">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">ClockTEC_3rdorder_func</code><span class="sig-paren">(</span><em>xarray</em>, <em>par</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.ClockTEC_3rdorder_func" title="Permalink to this definition">¶</a></dt>
<dd><p>clock tec fitting withextra parameter for third order ionospheric effects at lowest frequencies</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.ClockTECfunc">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">ClockTECfunc</code><span class="sig-paren">(</span><em>xarray</em>, <em>par</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.ClockTECfunc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.ClockTECfuncAllStations">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">ClockTECfuncAllStations</code><span class="sig-paren">(</span><em>xarray</em>, <em>par</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.ClockTECfuncAllStations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.getInitClock">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">getInitClock</code><span class="sig-paren">(</span><em>data</em>, <em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.getInitClock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.unwrapSparsePhases">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">unwrapSparsePhases</code><span class="sig-paren">(</span><em>phases</em>, <em>freqs</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.unwrapSparsePhases" title="Permalink to this definition">¶</a></dt>
<dd><p>unwrap phases, using frequency coverage</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.unwrapPhases">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">unwrapPhases</code><span class="sig-paren">(</span><em>phases</em>, <em>fitdata=None</em>, <em>maskrange=15</em>, <em>doFlag=True</em>, <em>flagfitdata=False</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.unwrapPhases" title="Permalink to this definition">¶</a></dt>
<dd><p>unwrap phases, remove jumps and get best match with fitdata</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.getInitPar">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">getInitPar</code><span class="sig-paren">(</span><em>data</em>, <em>freqs</em>, <em>nrTEC=40</em>, <em>nrClock=40</em>, <em>nrthird=0</em>, <em>initsol=()</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.getInitPar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.getClockTECFit">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">getClockTECFit</code><span class="sig-paren">(</span><em>ph</em>, <em>freq</em>, <em>stations</em>, <em>initSol=[]</em>, <em>returnResiduals=True</em>, <em>chi2cut=100000000.0</em>, <em>fit3rdorder=False</em>, <em>double_search_space=False</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.getClockTECFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.getPhaseWrapBase">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">getPhaseWrapBase</code><span class="sig-paren">(</span><em>freqs</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.getPhaseWrapBase" title="Permalink to this definition">¶</a></dt>
<dd><p>freqs: frequency grid of the data
return the step size from a local minima (2pi phase wrap) to the others [0]: TEC, [1]: clock</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.getResidualPhaseWraps">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">getResidualPhaseWraps</code><span class="sig-paren">(</span><em>avgResiduals</em>, <em>freqs</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.getResidualPhaseWraps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.correctWrapsFromResiduals">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">correctWrapsFromResiduals</code><span class="sig-paren">(</span><em>residualarray</em>, <em>flags</em>, <em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.correctWrapsFromResiduals" title="Permalink to this definition">¶</a></dt>
<dd><p>corrects solution jumps due to 2 pi phasewraps based on the average residuals</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.correctWraps">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">correctWraps</code><span class="sig-paren">(</span><em>tecarray</em>, <em>residualarray</em>, <em>freq</em>, <em>pos</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.correctWraps" title="Permalink to this definition">¶</a></dt>
<dd><p>corrects solution jumps due to 2 pi phasewraps based on spatial correlations of averaged TEC solutions. Also returns average constant phase  offset per station</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.get_first_good">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">get_first_good</code><span class="sig-paren">(</span><em>data</em>, <em>axis=1</em>, <em>check=&lt;function &lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.get_first_good" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.fitClockTEC.doFit">
<code class="descclassname">losoto.operations.fitClockTEC.</code><code class="descname">doFit</code><span class="sig-paren">(</span><em>phases</em>, <em>mask</em>, <em>freqs</em>, <em>stations</em>, <em>station_positions</em>, <em>axes</em>, <em>refstIdx='superterp'</em>, <em>flagBadChannels=True</em>, <em>flagcut=1.5</em>, <em>chi2cut=30000.0</em>, <em>removePhaseWraps=True</em>, <em>combine_pol=False</em>, <em>fit3rdorder=False</em>, <em>circular=False</em>, <em>initSol=[]</em>, <em>initoffsets=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.fitClockTEC.doFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-losoto.operations.flag">
<span id="losoto-operations-flag-module"></span><h2>losoto.operations.flag module<a class="headerlink" href="#module-losoto.operations.flag" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.flag.run_parser">
<code class="descclassname">losoto.operations.flag.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flag.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.flag.flag">
<code class="descclassname">losoto.operations.flag.</code><code class="descname">flag</code><span class="sig-paren">(</span><em>vals</em>, <em>weights</em>, <em>coord</em>, <em>solType</em>, <em>order</em>, <em>mode</em>, <em>preflagzeros</em>, <em>maxCycles</em>, <em>maxRms</em>, <em>maxRmsNoise</em>, <em>windowNoise</em>, <em>fixRmsNoise</em>, <em>replace</em>, <em>axesToFlag</em>, <em>selection</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flag.flag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.flag.run">
<code class="descclassname">losoto.operations.flag.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>axesToFlag</em>, <em>order</em>, <em>maxCycles=5</em>, <em>maxRms=5.0</em>, <em>maxRmsNoise=0.0</em>, <em>fixRmsNoise=0.0</em>, <em>windowNoise=11</em>, <em>replace=False</em>, <em>preflagzeros=False</em>, <em>mode='smooth'</em>, <em>refAnt=''</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flag.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation for LoSoTo implement a flagging procedure
WEIGHT: compliant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesToFlag</strong> : array of str</p>
<blockquote>
<div><p>Axes along which to smooth+find outlier (e.g. [‘time’, ‘freq’]), max 2 values.</p>
</div></blockquote>
<p><strong>order</strong> : array of int</p>
<blockquote>
<div><p>Order of the function fitted during detrending. Array must have same size of axesToFlag. If mode=smooth these are the window of the running median (0=all axis).</p>
</div></blockquote>
<p><strong>maxCycles</strong> : int, optional</p>
<blockquote>
<div><p>Max number of independent flagging cycles, by default 5.</p>
</div></blockquote>
<p><strong>maxRms</strong> : float, optional</p>
<blockquote>
<div><p>Rms to clip outliers, by default 5.</p>
</div></blockquote>
<p><strong>maxRmsNoise</strong> : float, optional</p>
<blockquote>
<div><p>Do a running rms and then flag those regions that have a rms higher than MaxRmsNoise*rms_of_rmses, by default 0 (ignored).</p>
</div></blockquote>
<p><strong>fixRmsNoise</strong> : float, optional</p>
<blockquote>
<div><p>Instead of calculating rms of the rmses use this value (it will not be multiplied by the MaxRmsNoise), by default 0 (ignored).</p>
</div></blockquote>
<p><strong>windowNoise</strong> : int, optional</p>
<blockquote>
<div><p>Window size for the running rms, by default 11.</p>
</div></blockquote>
<p><strong>replace</strong> : bool, optional</p>
<blockquote>
<div><p>Replace bad values with the interpolated ones, instead of flagging them. By default False.</p>
</div></blockquote>
<p><strong>preflagzeros</strong> : bool, optional</p>
<blockquote>
<div><p>Flag zeros/ones (bad solutions in BBS/DPPP). They should be flagged at import time. By default False.</p>
</div></blockquote>
<p><strong>mode, str, optional</strong></p>
<blockquote>
<div><p>Detrending algorithm smooth / poly / spline. By default smooth.</p>
</div></blockquote>
<p><strong>refAnt</strong> : str, optional</p>
<blockquote>
<div><p>Reference antenna, by default None.</p>
</div></blockquote>
<p><strong>ncpu</strong> : int, optional</p>
<blockquote class="last">
<div><p>Number of cpu to use, by default all available.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.flagextend">
<span id="losoto-operations-flagextend-module"></span><h2>losoto.operations.flagextend module<a class="headerlink" href="#module-losoto.operations.flagextend" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.flagextend.run_parser">
<code class="descclassname">losoto.operations.flagextend.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flagextend.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.flagextend.flag">
<code class="descclassname">losoto.operations.flagextend.</code><code class="descname">flag</code><span class="sig-paren">(</span><em>weights, coord, axesToExt, selection, percent=90, size=[0], maxCycles=3, outQueue=None</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flagextend.flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag data if surreounded by other flagged data
weights = the weights to convert into flags
percent = percent of surrounding flagged point to extend the flag</p>
<p>return: flags array and final rms</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.flagextend.run">
<code class="descclassname">losoto.operations.flagextend.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>axesToExt</em>, <em>size</em>, <em>percent=50.0</em>, <em>maxCycles=3</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.flagextend.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation for LoSoTo implement a extend flag procedure
It can work in multi dimensional space and for each datum check if the surrounding data are flagged to a certain %, then flag also that datum
The size of the surrounding footprint can be tuned
WEIGHT: compliant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesToExt</strong> : list of str</p>
<blockquote>
<div><p>Axes used to find close flags.</p>
</div></blockquote>
<p><strong>size</strong> : list of int</p>
<blockquote>
<div><p>Size of the window (diameter), per axis. If 0 is given then the entire length of the axis is assumed.
Must be a vector of same length of Axes.</p>
</div></blockquote>
<p><strong>percent</strong> : float, optional</p>
<blockquote>
<div><p>Percent of flagged data around the point to flag it, by default 50.</p>
</div></blockquote>
<p><strong>maxCycles</strong> : int, optional</p>
<blockquote>
<div><p>Number of independent cycles of flag expansion, by default 3.</p>
</div></blockquote>
<p><strong>ncpu</strong> : int, optional</p>
<blockquote class="last">
<div><p>Number of CPU used, by default all available.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.interp">
<span id="losoto-operations-interp-module"></span><h2>losoto.operations.interp module<a class="headerlink" href="#module-losoto.operations.interp" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.interp.run">
<code class="descclassname">losoto.operations.interp.</code><code class="descname">run</code><span class="sig-paren">(</span><em>step</em>, <em>parset</em>, <em>H</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.interp.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the solutions from one table into a destination table</p>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.norm">
<span id="losoto-operations-norm-module"></span><h2>losoto.operations.norm module<a class="headerlink" href="#module-losoto.operations.norm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.norm.run_parser">
<code class="descclassname">losoto.operations.norm.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.norm.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.norm.run">
<code class="descclassname">losoto.operations.norm.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>axesToNorm</em>, <em>normVal=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.norm.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the solutions to a given value
WEIGHT: Weights compliant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesToNorm</strong> : array of str</p>
<blockquote>
<div><p>Axes along which compute the normalization.</p>
</div></blockquote>
<p><strong>normVal</strong> : float, optional</p>
<blockquote class="last">
<div><p>Number to normalize to vals = vals * (normVal/valsMean), by default 1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.plot">
<span id="losoto-operations-plot-module"></span><h2>losoto.operations.plot module<a class="headerlink" href="#module-losoto.operations.plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.plot.run_parser">
<code class="descclassname">losoto.operations.plot.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plot.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.plot.plot">
<code class="descclassname">losoto.operations.plot.</code><code class="descname">plot</code><span class="sig-paren">(</span><em>Nplots</em>, <em>NColFig</em>, <em>figSize</em>, <em>cmesh</em>, <em>axesInPlot</em>, <em>axisInTable</em>, <em>xvals</em>, <em>yvals</em>, <em>xlabelunit</em>, <em>ylabelunit</em>, <em>datatype</em>, <em>filename</em>, <em>titles</em>, <em>log</em>, <em>dataCube</em>, <em>minZ</em>, <em>maxZ</em>, <em>plotFlag</em>, <em>makeMovie</em>, <em>antCoords</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plot.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.plot.run">
<code class="descclassname">losoto.operations.plot.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab, axesInPlot, axisInTable='', axisInCol='', axisDiff='', NColFig=0, figSize=[0, 0], minmax=[0, 0], log='', plotFlag=False, doUnwrap=False, refAnt='', soltabsToAdd='', makeAntPlot=False, makeMovie=False, prefix='', ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plot.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation for LoSoTo implements basic plotting
WEIGHT: flag-only compliant, no need for weight</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesInPlot</strong> : array of str</p>
<blockquote>
<div><p>1- or 2-element array which says the coordinates to plot (2 for 3D plots).</p>
</div></blockquote>
<p><strong>axisInTable</strong> : str, optional</p>
<blockquote>
<div><p>the axis to plot on a page - e.g. ant to get all antenna’s on one file. By default ‘’.</p>
</div></blockquote>
<p><strong>axisInCol</strong> : str, optional</p>
<blockquote>
<div><p>The axis to plot in different colours - e.g. pol to get correlations with different colors. By default ‘’.</p>
</div></blockquote>
<p><strong>axisDiff</strong> : str, optional</p>
<blockquote>
<div><p>This must be a len=2 axis and the plot will have the differential value - e.g. ‘pol’ to plot XX-YY. By default ‘’.</p>
</div></blockquote>
<p><strong>NColFig</strong> : int, optional</p>
<blockquote>
<div><p>Number of columns in a multi-table image. By default is automatically chosen.</p>
</div></blockquote>
<p><strong>figSize</strong> : array of int, optional</p>
<blockquote>
<div><p>Size of the image [x,y], if one of the values is 0, then it is automatically chosen. By default automatic set.</p>
</div></blockquote>
<p><strong>minmax</strong> : array of float, optional</p>
<blockquote>
<div><p>Min max value for the independent variable (0 means automatic). By default 0.</p>
</div></blockquote>
<p><strong>log</strong> : bool, optional</p>
<blockquote>
<div><p>Use Log=’XYZ’ to set which axes to put in Log. By default ‘’.</p>
</div></blockquote>
<p><strong>plotFlag</strong> : bool, optional</p>
<blockquote>
<div><p>Whether to plot also flags as red points in 2D plots. By default False.</p>
</div></blockquote>
<p><strong>doUnwrap</strong> : bool, optional</p>
<blockquote>
<div><p>Unwrap phases. By default False.</p>
</div></blockquote>
<p><strong>refAnt</strong> : str, optional</p>
<blockquote>
<div><p>Reference antenna for phases. By default None.</p>
</div></blockquote>
<p><strong>soltabsToAdd</strong> : str, optional</p>
<blockquote>
<div><p>Tables to “add” (e.g. ‘sol000/tec000’), it works only for tec and clock to be added to phases. By default None.</p>
</div></blockquote>
<p><strong>makeAntPlot</strong> : bool, optional</p>
<blockquote>
<div><p>Make a plot containing antenna coordinates in x,y and in color the value to plot, Axes must be [ant]. By default False.</p>
</div></blockquote>
<p><strong>makeMovie</strong> : bool, optional</p>
<blockquote>
<div><p>Make a movie summing up all the produced plots, by default False.</p>
</div></blockquote>
<p><strong>prefix</strong> : str, optional</p>
<blockquote>
<div><p>Prefix to add before the self-generated filename, by default None.</p>
</div></blockquote>
<p><strong>ncpu</strong> : int, optional</p>
<blockquote class="last">
<div><p>Number of cpus, by default all available.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.plotscreen">
<span id="losoto-operations-plotscreen-module"></span><h2>losoto.operations.plotscreen module<a class="headerlink" href="#module-losoto.operations.plotscreen" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.plotscreen.run_parser">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.phase_cm">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">phase_cm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.phase_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns colormap for phase plots</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.calculate_screen">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">calculate_screen</code><span class="sig-paren">(</span><em>inscreen</em>, <em>residuals</em>, <em>pp</em>, <em>N_piercepoints</em>, <em>k</em>, <em>east</em>, <em>north</em>, <em>up</em>, <em>T</em>, <em>Nx</em>, <em>Ny</em>, <em>sindx</em>, <em>height</em>, <em>beta_val</em>, <em>r_0</em>, <em>is_phase</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.calculate_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates screen images</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>inscreen</strong> : array</p>
<blockquote>
<div><p>Array of screen values at the piercepoints</p>
</div></blockquote>
<p><strong>residuals</strong> : array</p>
<blockquote>
<div><p>Array of screen residuals at the piercepoints</p>
</div></blockquote>
<p><strong>pp</strong> : array</p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>N_piercepoints</strong> : int</p>
<blockquote>
<div><p>Number of pierce points</p>
</div></blockquote>
<p><strong>k</strong> : int</p>
<blockquote>
<div><p>Time index</p>
</div></blockquote>
<p><strong>east</strong> : array</p>
<blockquote>
<div><p>East array</p>
</div></blockquote>
<p><strong>north</strong> : array</p>
<blockquote>
<div><p>North array</p>
</div></blockquote>
<p><strong>up</strong> : array</p>
<blockquote>
<div><p>Up array</p>
</div></blockquote>
<p><strong>T</strong> : array</p>
<blockquote>
<div><p>T array</p>
</div></blockquote>
<p><strong>Nx</strong> : int</p>
<blockquote>
<div><p>Number of pixels in x for screen</p>
</div></blockquote>
<p><strong>Ny</strong> : int</p>
<blockquote>
<div><p>Number of pixels in y for screen</p>
</div></blockquote>
<p><strong>sindx</strong> : int</p>
<blockquote>
<div><p>Station index</p>
</div></blockquote>
<p><strong>height</strong> : float</p>
<blockquote>
<div><p>height of screen (m)</p>
</div></blockquote>
<p><strong>beta_val</strong> : float</p>
<blockquote>
<div><p>power-law index for phase structure function (5/3 =&gt;
pure Kolmogorov turbulence)</p>
</div></blockquote>
<p><strong>r_0</strong> : float</p>
<blockquote>
<div><p>scale size of phase fluctuations</p>
</div></blockquote>
<p><strong>is_phase</strong> : bool</p>
<blockquote class="last">
<div><p>input screen is a phase screen</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.plot_frame">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">plot_frame</code><span class="sig-paren">(</span><em>screen</em>, <em>fitted_phase1</em>, <em>residuals</em>, <em>weights</em>, <em>x</em>, <em>y</em>, <em>k</em>, <em>lower</em>, <em>upper</em>, <em>vmin</em>, <em>vmax</em>, <em>source_names</em>, <em>show_source_names</em>, <em>station_names</em>, <em>sindx</em>, <em>root_dir</em>, <em>prestr</em>, <em>is_image_plane</em>, <em>midRA</em>, <em>midDec</em>, <em>order</em>, <em>is_phase</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.plot_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots screen images</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>screen</strong> : array</p>
<blockquote>
<div><p>Image of screen values</p>
</div></blockquote>
<p><strong>fitted_phase1</strong> : array</p>
<blockquote>
<div><p>Array of fitted phase values</p>
</div></blockquote>
<p><strong>residuals</strong> : array</p>
<blockquote>
<div><p>Array of phase residuals at the piercepoints</p>
</div></blockquote>
<p><strong>weights</strong> : array</p>
<blockquote>
<div><p>Array of weights at the piercepoints</p>
</div></blockquote>
<p><strong>x</strong> : array</p>
<blockquote>
<div><p>Array of piercepoint x locations</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>Array of piercepoint y locations</p>
</div></blockquote>
<p><strong>k</strong> : int</p>
<blockquote>
<div><p>Time index</p>
</div></blockquote>
<p><strong>lower</strong> : array</p>
<blockquote>
<div><p>Array of lower limits for plot</p>
</div></blockquote>
<p><strong>upper</strong> : array</p>
<blockquote>
<div><p>Array of upper limits for plot</p>
</div></blockquote>
<p><strong>vmin</strong> : float</p>
<blockquote>
<div><p>minimum value for plot range</p>
</div></blockquote>
<p><strong>vmax</strong> : float</p>
<blockquote>
<div><p>maximum value for plot range</p>
</div></blockquote>
<p><strong>source_names</strong> : list</p>
<blockquote>
<div><p>List of source (direction) names</p>
</div></blockquote>
<p><strong>show_source_names</strong> : bool</p>
<blockquote>
<div><p>label sources on screen plots</p>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>order of screen</p>
</div></blockquote>
<p><strong>is_phase</strong> : bool</p>
<blockquote class="last">
<div><p>True if screens are phase screens</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.make_screen_plots">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">make_screen_plots</code><span class="sig-paren">(</span><em>pp</em>, <em>inscreen</em>, <em>inresiduals</em>, <em>weights</em>, <em>station_names</em>, <em>station_positions</em>, <em>source_names</em>, <em>times</em>, <em>height</em>, <em>station_order</em>, <em>beta_val</em>, <em>r_0</em>, <em>prefix='frame_'</em>, <em>remove_gradient=True</em>, <em>show_source_names=False</em>, <em>min_val=None</em>, <em>max_val=None</em>, <em>is_phase=False</em>, <em>midRA=0.0</em>, <em>midDec=0.0</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.make_screen_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes plots of screens</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pp</strong> : array</p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>inscreen</strong> : array</p>
<blockquote>
<div><p>Array of screen values at the piercepoints with order [dir, time, ant]</p>
</div></blockquote>
<p><strong>residuals</strong> : array</p>
<blockquote>
<div><p>Array of screen residuals at the piercepoints with order [dir, time, ant]</p>
</div></blockquote>
<p><strong>weights</strong> : array</p>
<blockquote>
<div><p>Array of weights for each piercepoint with order [dir, time, ant]</p>
</div></blockquote>
<p><strong>source_names: array</strong></p>
<blockquote>
<div><p>Array of source names</p>
</div></blockquote>
<p><strong>times</strong> : array</p>
<blockquote>
<div><p>Array of times</p>
</div></blockquote>
<p><strong>height</strong> : float</p>
<blockquote>
<div><p>Height of screen (m)</p>
</div></blockquote>
<p><strong>station_order</strong> : list</p>
<blockquote>
<div><p>List of order of screens per station (e.g., number of KL base vectors to keep)</p>
</div></blockquote>
<p><strong>r_0</strong> : float</p>
<blockquote>
<div><p>Scale size of phase fluctuations</p>
</div></blockquote>
<p><strong>beta_val</strong> : float</p>
<blockquote>
<div><p>Power-law index for phase structure function</p>
</div></blockquote>
<p><strong>prefix</strong> : str</p>
<blockquote>
<div><p>Prefix for output file names</p>
</div></blockquote>
<p><strong>remove_gradient</strong> : bool</p>
<blockquote>
<div><p>Fit and remove a gradient from each screen</p>
</div></blockquote>
<p><strong>show_source_names</strong> : bool</p>
<blockquote>
<div><p>Label sources on screen plots</p>
</div></blockquote>
<p><strong>min_val</strong> : float</p>
<blockquote>
<div><p>Minimum value for plot range</p>
</div></blockquote>
<p><strong>max_val</strong> : float</p>
<blockquote>
<div><p>Maximum value for plot range</p>
</div></blockquote>
<p><strong>is_phase</strong> : bool</p>
<blockquote>
<div><p>Input screen is a phase screen</p>
</div></blockquote>
<p><strong>midRA</strong> : float</p>
<blockquote>
<div><p>RA for WCS reference in degrees</p>
</div></blockquote>
<p><strong>midDec</strong> : float</p>
<blockquote>
<div><p>Dec for WCS reference in degrees</p>
</div></blockquote>
<p><strong>ncpu</strong> : int</p>
<blockquote class="last">
<div><p>Number of CPUs to use</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.fitPLaneLTSQ">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">fitPLaneLTSQ</code><span class="sig-paren">(</span><em>XYZ</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.fitPLaneLTSQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a plane to an XYZ point cloud</p>
<p>Returns (a, b, c), where Z = aX + bY + c</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>XYZ</strong> : array</p>
<blockquote>
<div><p>point cloud</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(a, b, c)</strong> : floats</p>
<blockquote class="last">
<div><p>plane parameters, where Z = aX + bY + c</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.plotscreen.run">
<code class="descclassname">losoto.operations.plotscreen.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>ressoltab=None</em>, <em>minZ=-3.2</em>, <em>maxZ=3.2</em>, <em>prefix=''</em>, <em>remove_gradient=False</em>, <em>show_source_names=False</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.plotscreen.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot screens (one plot is made per time and per station)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltab</strong> : solution table</p>
<blockquote>
<div><p>Soltab containing screen.</p>
</div></blockquote>
<p><strong>ressoltab</strong> : solution table, optional</p>
<blockquote>
<div><p>Soltab containing the screen residuals.</p>
</div></blockquote>
<p><strong>minZ</strong> : float, optional</p>
<blockquote>
<div><p>Minimum value of colorbar scale.</p>
</div></blockquote>
<p><strong>maxZ</strong> : float, optional</p>
<blockquote>
<div><p>Max value of colorbar scale.</p>
</div></blockquote>
<p><strong>prefix</strong> : str, optional</p>
<blockquote>
<div><p>String to prepend to output plots.</p>
</div></blockquote>
<p><strong>remove_gradient</strong> : bool, optional</p>
<blockquote>
<div><p>If True, remove gradient before plotting.</p>
</div></blockquote>
<p><strong>show_source_names</strong> : bool, optional</p>
<blockquote>
<div><p>If True, source names are overplotted.</p>
</div></blockquote>
<p><strong>ncpu</strong> : int, optional</p>
<blockquote class="last">
<div><p>Number of CPUs to use. If 0, all are used.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.reset">
<span id="losoto-operations-reset-module"></span><h2>losoto.operations.reset module<a class="headerlink" href="#module-losoto.operations.reset" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.reset.run_parser">
<code class="descclassname">losoto.operations.reset.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reset.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.reset.run">
<code class="descclassname">losoto.operations.reset.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reset.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation reset all the selected amplitudes to 1
and all other selected solution types to 0
WEIGHT: flag compliant, no need for weight</p>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.residuals">
<span id="losoto-operations-residuals-module"></span><h2>losoto.operations.residuals module<a class="headerlink" href="#module-losoto.operations.residuals" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.residuals.run_parser">
<code class="descclassname">losoto.operations.residuals.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.residuals.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.residuals.run">
<code class="descclassname">losoto.operations.residuals.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>soltabsToSub</em>, <em>ratio=False</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.residuals.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract/divide two tables or a clock/tec/tec3rd/rm from a phase.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltabsToSub</strong> : list of str</p>
<blockquote>
<div><p>List of soltabs to subtract</p>
</div></blockquote>
<p><strong>ratio</strong> : bool, optional</p>
<blockquote class="last">
<div><p>Return the ratio instead of subtracting, by default False.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.reweight">
<span id="losoto-operations-reweight-module"></span><h2>losoto.operations.reweight module<a class="headerlink" href="#module-losoto.operations.reweight" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.reweight.run_parser">
<code class="descclassname">losoto.operations.reweight.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reweight.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.reweight.rolling_window_lastaxis">
<code class="descclassname">losoto.operations.reweight.</code><code class="descname">rolling_window_lastaxis</code><span class="sig-paren">(</span><em>a</em>, <em>window</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reweight.rolling_window_lastaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Directly taken from Erik Rigtorp’s post to numpy-discussion.
&lt;<a class="reference external" href="http://www.mail-archive.com/numpy-discussion&#64;scipy.org/msg29450.html">http://www.mail-archive.com/numpy-discussion&#64;scipy.org/msg29450.html</a>&gt;</p>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.reweight.nancircstd">
<code class="descclassname">losoto.operations.reweight.</code><code class="descname">nancircstd</code><span class="sig-paren">(</span><em>samples</em>, <em>axis=None</em>, <em>is_phase=True</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reweight.nancircstd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the circular standard deviation</p>
<p>Based on scipy.stats.circstd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>imag</strong> : array_like</p>
<blockquote>
<div><p>Input array.</p>
</div></blockquote>
<p><strong>axis</strong> : int, optional</p>
<blockquote>
<div><p>Axis along which standard deviations are computed.  The default is
to compute the standard deviation of the flattened array.</p>
</div></blockquote>
<p><strong>is_phase</strong> : bool, optional</p>
<blockquote>
<div><p>If True, samples are assumed to be phases. If False, they are assumed
to be either real or imaginary values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>circstd</strong> : float</p>
<blockquote class="last">
<div><p>Circular standard deviation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.reweight.estimate_weights_window">
<code class="descclassname">losoto.operations.reweight.</code><code class="descname">estimate_weights_window</code><span class="sig-paren">(</span><em>sindx</em>, <em>vals</em>, <em>nmedian</em>, <em>nstddev</em>, <em>type</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reweight.estimate_weights_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Set weights using a median-filter method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sindx: int</strong></p>
<blockquote>
<div><p>Index of station</p>
</div></blockquote>
<p><strong>vals: array</strong></p>
<blockquote>
<div><p>Array of values</p>
</div></blockquote>
<p><strong>nmedian: odd int</strong></p>
<blockquote>
<div><p>Size of median time window</p>
</div></blockquote>
<p><strong>nstddev: odd int</strong></p>
<blockquote>
<div><p>Size of stddev time window</p>
</div></blockquote>
<p><strong>typ: str</strong></p>
<blockquote class="last">
<div><p>Type of values (e.g., ‘phase’)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.reweight.run">
<code class="descclassname">losoto.operations.reweight.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>method='uniform'</em>, <em>weightVal=1.0</em>, <em>nmedian=3</em>, <em>nstddev=251</em>, <em>soltabImport=''</em>, <em>flagBad=False</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.reweight.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation resets the weight vals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>method</strong> : str, optional</p>
<blockquote>
<div><p>One of ‘uniform’ (single value) or ‘window’ (sliding window in time).</p>
</div></blockquote>
<p><strong>weightVal</strong> : float, optional</p>
<blockquote>
<div><p>Set weights to this values (0=flagged), by default 1.</p>
</div></blockquote>
<p><strong>nmedian</strong> : odd int, optional</p>
<blockquote>
<div><p>Median window size in number of timeslots for ‘window’ method.
If nonzero, a median-smoothed version of the input values is
subtracted to detrend them. If 0, no smoothing or subtraction is
done.</p>
</div></blockquote>
<p><strong>nstddev</strong> : odd int, optional</p>
<blockquote>
<div><p>Standard deviation window size in number of timeslots for ‘window’ method.</p>
</div></blockquote>
<p><strong>soltabImport</strong> : str, optional</p>
<blockquote>
<div><p>Name of a soltab. Copy weights from this soltab, by default do not copy.</p>
</div></blockquote>
<p><strong>flagBad</strong> : bool, optional</p>
<blockquote class="last">
<div><p>Re-apply flags to bad values, by default False.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.screenvalues">
<span id="losoto-operations-screenvalues-module"></span><h2>losoto.operations.screenvalues module<a class="headerlink" href="#module-losoto.operations.screenvalues" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.screenvalues.run_parser">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.screenvalues.calculate_tecsp">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">calculate_tecsp</code><span class="sig-paren">(</span><em>screen1</em>, <em>screen2</em>, <em>pp</em>, <em>directions</em>, <em>k</em>, <em>sindx</em>, <em>beta_val</em>, <em>r_0</em>, <em>freq1</em>, <em>freq2</em>, <em>midRA</em>, <em>midDec</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.calculate_tecsp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates TEC and scalar phase from screens at two frequencies</p>
<dl class="docutils">
<dt>screen1: array</dt>
<dd>Array of screen values at the piercepoints for freq1</dd>
<dt>screen2: array</dt>
<dd>Array of screen values at the piercepoints for freq2</dd>
<dt>pp: array</dt>
<dd>Array of piercepoint locations</dd>
<dt>directions: array</dt>
<dd>Array of RA, Dec in degrees for which phases are desired</dd>
<dt>r_0: float</dt>
<dd>Scale size of phase fluctuations</dd>
<dt>beta_val: float</dt>
<dd>Power-law index for phase structure function (5/3 =&gt;
pure Kolmogorov turbulence)</dd>
<dt>freq1: float</dt>
<dd>Frequency of screen1 in Hz</dd>
<dt>freq2: float</dt>
<dd>Frequency of screen2 in Hz</dd>
<dt>midRA <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>RA for WCS reference in degrees</dd>
<dt>midDec <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Dec for WCS reference in degrees</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.screenvalues.calculate_val">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">calculate_val</code><span class="sig-paren">(</span><em>screen</em>, <em>pp</em>, <em>directions</em>, <em>k</em>, <em>sindx</em>, <em>beta_val</em>, <em>r_0</em>, <em>midRA</em>, <em>midDec</em>, <em>outQueue</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.calculate_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates values from screen</p>
<dl class="docutils">
<dt>screen: array</dt>
<dd>Array of screen values at the piercepoints</dd>
<dt>pp: array</dt>
<dd>Array of piercepoint locations</dd>
<dt>directions: array</dt>
<dd>Array of RA, Dec in degrees for which phases are desired</dd>
<dt>r_0: float</dt>
<dd>Scale size of phase fluctuations</dd>
<dt>beta_val: float</dt>
<dd>Power-law index for phase structure function (5/3 =&gt;
pure Kolmogorov turbulence)</dd>
<dt>midRA <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>RA for WCS reference in degrees</dd>
<dt>midDec <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Dec for WCS reference in degrees</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.screenvalues.screens_to_tecsp">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">screens_to_tecsp</code><span class="sig-paren">(</span><em>pp</em>, <em>screen1</em>, <em>screen2</em>, <em>directions</em>, <em>station_positions</em>, <em>beta_val</em>, <em>r_0</em>, <em>freq1</em>, <em>freq2</em>, <em>midRA=0.0</em>, <em>midDec=0.0</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.screens_to_tecsp" title="Permalink to this definition">¶</a></dt>
<dd><p>Caculates phases from screens</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pp: array</strong></p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>screen1: array</strong></p>
<blockquote>
<div><p>Array of screen values at the piercepoints for freq1</p>
</div></blockquote>
<p><strong>screen2: array</strong></p>
<blockquote>
<div><p>Array of screen values at the piercepoints for freq2</p>
</div></blockquote>
<p><strong>directions: list of arrays</strong></p>
<blockquote>
<div><p>List of (RA, Dec) arrays in radians for which phases are desired</p>
</div></blockquote>
<p><strong>height: float</strong></p>
<blockquote>
<div><p>Height of screen (m)</p>
</div></blockquote>
<p><strong>r_0: float</strong></p>
<blockquote>
<div><p>Scale size of phase fluctuations</p>
</div></blockquote>
<p><strong>beta_val: float</strong></p>
<blockquote>
<div><p>Power-law index for phase structure function (5/3 =&gt;
pure Kolmogorov turbulence)</p>
</div></blockquote>
<p><strong>freq1: float</strong></p>
<blockquote>
<div><p>Frequency of screen1 in Hz</p>
</div></blockquote>
<p><strong>freq2: float</strong></p>
<blockquote>
<div><p>Frequency of screen2 in Hz</p>
</div></blockquote>
<p><strong>midRA</strong> : float</p>
<blockquote>
<div><p>RA for WCS reference in degrees</p>
</div></blockquote>
<p><strong>midDec</strong> : float</p>
<blockquote>
<div><p>Dec for WCS reference in degrees</p>
</div></blockquote>
<p><strong>ncpu: int</strong></p>
<blockquote class="last">
<div><p>Number of CPUs to use</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.screenvalues.screen_to_val">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">screen_to_val</code><span class="sig-paren">(</span><em>pp</em>, <em>screen</em>, <em>directions</em>, <em>station_positions</em>, <em>beta_val</em>, <em>r_0</em>, <em>midRA=0.0</em>, <em>midDec=0.0</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.screen_to_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Caculates phases from screens</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pp: array</strong></p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>screen: array</strong></p>
<blockquote>
<div><p>Array of screen values at the piercepoints with axes [dir_ind, time_ind,
freq_ind, ant_ind, pol_ind]</p>
</div></blockquote>
<p><strong>directions: list of arrays</strong></p>
<blockquote>
<div><p>List of (RA, Dec) arrays in radians for which phases are desired</p>
</div></blockquote>
<p><strong>height: float</strong></p>
<blockquote>
<div><p>Height of screen (m)</p>
</div></blockquote>
<p><strong>r_0: float</strong></p>
<blockquote>
<div><p>Scale size of phase fluctuations</p>
</div></blockquote>
<p><strong>beta_val: float</strong></p>
<blockquote>
<div><p>Power-law index for phase structure function (5/3 =&gt;
pure Kolmogorov turbulence)</p>
</div></blockquote>
<p><strong>midRA</strong> : float</p>
<blockquote>
<div><p>RA for WCS reference in degrees</p>
</div></blockquote>
<p><strong>midDec</strong> : float</p>
<blockquote>
<div><p>Dec for WCS reference in degrees</p>
</div></blockquote>
<p><strong>ncpu: int</strong></p>
<blockquote class="last">
<div><p>Number of CPUs to use</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.screenvalues.run">
<code class="descclassname">losoto.operations.screenvalues.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab1</em>, <em>source_dict</em>, <em>outsoltab</em>, <em>soltab2=None</em>, <em>ncpu=0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.screenvalues.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate phases from screens</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltab1</strong> : solution table</p>
<blockquote>
<div><p>Soltab containing the screen at frequency 1</p>
</div></blockquote>
<p><strong>source_dict</strong> : dict</p>
<blockquote>
<div><p>Dictionary of source positions for which phases are desired</p>
</div></blockquote>
<p><strong>outsoltab</strong> : str</p>
<blockquote>
<div><p>Name of output solution table. If TEC+scalarphase solutions are desired,
two solution tables are made: ‘tecoutsoltab’ and ‘scalarphaseoutsoltab’</p>
</div></blockquote>
<p><strong>soltab2</strong> : solution table, optional</p>
<blockquote>
<div><p>Soltab containing the screens at frequency 2 (needed for TEC+scalar
phase)</p>
</div></blockquote>
<p><strong>ncpu</strong> : int, optional</p>
<blockquote class="last">
<div><p>Number of CPUs to use. If 0, all are used</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.smooth">
<span id="losoto-operations-smooth-module"></span><h2>losoto.operations.smooth module<a class="headerlink" href="#module-losoto.operations.smooth" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.smooth.run_parser">
<code class="descclassname">losoto.operations.smooth.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.smooth.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.smooth.run">
<code class="descclassname">losoto.operations.smooth.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>axesToSmooth</em>, <em>size=[]</em>, <em>mode='runningmedian'</em>, <em>degree=1</em>, <em>replace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.smooth.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This operation for LoSoTo implement a smoothing function: running-median on an arbitrary number of axes, running polyfit on one axis, or set all solutions to mean/median value.
WEIGHH: flag ready</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axesToSmooth</strong> : array of str</p>
<blockquote>
<div><p>Axes used to compute the smoothing function.</p>
</div></blockquote>
<p><strong>size</strong> : array of int, optional</p>
<blockquote>
<div><p>Window size for the runningmedian and runningpoly (array of same size of axesToSmooth), by default [].</p>
</div></blockquote>
<p><strong>mode</strong> : {‘runningmedian’,’runningpoly’,’mean’,’median’}, optional</p>
<blockquote>
<div><p>Runningmedian or runningpoly or mean or median (these last two values set all the solutions to the mean/median), by default “runningmedian”.</p>
</div></blockquote>
<p><strong>degree</strong> : int, optional</p>
<blockquote>
<div><p>Degrees of the polynomia for the runningpoly, by default 1.</p>
</div></blockquote>
<p><strong>replace</strong> : bool, optional</p>
<blockquote class="last">
<div><p>Flagged data are replaced with smoothed value and unflagged, by default False.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.stationscreen">
<span id="losoto-operations-stationscreen-module"></span><h2>losoto.operations.stationscreen module<a class="headerlink" href="#module-losoto.operations.stationscreen" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.stationscreen.run_parser">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">run_parser</code><span class="sig-paren">(</span><em>soltab</em>, <em>parser</em>, <em>step</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.run_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.calculate_piercepoints">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">calculate_piercepoints</code><span class="sig-paren">(</span><em>station_positions</em>, <em>source_positions</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.calculate_piercepoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns array of piercepoint locations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>station_positions</strong> : array</p>
<blockquote>
<div><p>Array of station positions</p>
</div></blockquote>
<p><strong>source_positions</strong> : array</p>
<blockquote>
<div><p>Array of source positions</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pp</strong> : array</p>
<blockquote>
<div><p>Array of pierce points</p>
</div></blockquote>
<p><strong>midRA</strong> : float</p>
<blockquote>
<div><p>Reference RA for WCS system (deg)</p>
</div></blockquote>
<p><strong>midDec</strong> : float</p>
<blockquote class="last">
<div><p>Reference Dec for WCS system (deg)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.get_ant_dist">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">get_ant_dist</code><span class="sig-paren">(</span><em>ant_xyz</em>, <em>ref_xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.get_ant_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns distance between ant and ref in m</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ant_xyz</strong> : array</p>
<blockquote>
<div><p>Array of station position</p>
</div></blockquote>
<p><strong>ref_xyz</strong> : array</p>
<blockquote>
<div><p>Array of reference position</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist</strong> : float</p>
<blockquote class="last">
<div><p>Distance between station and reference positions</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.getxy">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">getxy</code><span class="sig-paren">(</span><em>RA</em>, <em>Dec</em>, <em>midRA=None</em>, <em>midDec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.getxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns array of projected x and y values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>RA, Dec</strong> : list</p>
<blockquote>
<div><p>Lists of RA and Dec in degrees</p>
</div></blockquote>
<p><strong>midRA</strong> : float</p>
<blockquote>
<div><p>RA for WCS reference in degrees</p>
</div></blockquote>
<p><strong>midDec</strong> : float</p>
<blockquote>
<div><p>Dec for WCS reference in degrees</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x, y</strong> : numpy array, numpy array, float, float</p>
<blockquote class="last">
<div><p>arrays of x and y values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.radec2xy">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">radec2xy</code><span class="sig-paren">(</span><em>RA</em>, <em>Dec</em>, <em>refRA=None</em>, <em>refDec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.radec2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x, y for input ra, dec.</p>
<p>Note that the reference RA and Dec must be the same in calls to both
radec2xy() and xy2radec() if matched pairs of (x, y) &lt;=&gt; (RA, Dec) are
desired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>RA</strong> : list</p>
<blockquote>
<div><p>List of RA values in degrees</p>
</div></blockquote>
<p><strong>Dec</strong> : list</p>
<blockquote>
<div><p>List of Dec values in degrees</p>
</div></blockquote>
<p><strong>refRA</strong> : float, optional</p>
<blockquote>
<div><p>Reference RA in degrees.</p>
</div></blockquote>
<p><strong>refDec</strong> : float, optional</p>
<blockquote>
<div><p>Reference Dec in degrees</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x, y</strong> : list, list</p>
<blockquote class="last">
<div><p>Lists of x and y pixel values corresponding to the input RA and Dec
values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.xy2radec">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">xy2radec</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>refRA=0.0</em>, <em>refDec=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.xy2radec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x, y for input ra, dec.</p>
<p>Note that the reference RA and Dec must be the same in calls to both
radec2xy() and xy2radec() if matched pairs of (x, y) &lt;=&gt; (RA, Dec) are
desired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : list</p>
<blockquote>
<div><p>List of x values in pixels</p>
</div></blockquote>
<p><strong>y</strong> : list</p>
<blockquote>
<div><p>List of y values in pixels</p>
</div></blockquote>
<p><strong>refRA</strong> : float, optional</p>
<blockquote>
<div><p>Reference RA in degrees</p>
</div></blockquote>
<p><strong>refDec</strong> : float, optional</p>
<blockquote>
<div><p>Reference Dec in degrees</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>RA, Dec</strong> : list, list</p>
<blockquote class="last">
<div><p>Lists of RA and Dec values corresponding to the input x and y pixel
values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.makeWCS">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">makeWCS</code><span class="sig-paren">(</span><em>refRA</em>, <em>refDec</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.makeWCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes simple WCS object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>refRA</strong> : float</p>
<blockquote>
<div><p>Reference RA in degrees</p>
</div></blockquote>
<p><strong>refDec</strong> : float</p>
<blockquote>
<div><p>Reference Dec in degrees</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>w</strong> : astropy.wcs.WCS object</p>
<blockquote class="last">
<div><p>A simple TAN-projection WCS object for specified reference position</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.flag_outliers">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">flag_outliers</code><span class="sig-paren">(</span><em>weights</em>, <em>residual</em>, <em>nsigma</em>, <em>screen_type</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.flag_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Flags outliers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>weights</strong> : array</p>
<blockquote>
<div><p>Array of weights</p>
</div></blockquote>
<p><strong>phase_residual</strong> : array</p>
<blockquote>
<div><p>Array of residual values from phase screen fitting (rad)</p>
</div></blockquote>
<p><strong>nsigma</strong> : float</p>
<blockquote>
<div><p>Number of sigma above with outliers are clipped (= weight set to zero)</p>
</div></blockquote>
<p><strong>screen_type</strong> : str</p>
<blockquote>
<div><p>Type of screen: ‘phase’ or ‘amplitude’</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>weights</strong> : array</p>
<blockquote class="last">
<div><p>array of weights, with flagged times set to 0</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.circ_chi2">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">circ_chi2</code><span class="sig-paren">(</span><em>samples</em>, <em>weights</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.circ_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the circular chi^2</p>
<p>Based on scipy.stats.circstd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>samples</strong> : array_like</p>
<blockquote>
<div><p>Input array.</p>
</div></blockquote>
<p><strong>weights</strong> : array_like</p>
<blockquote>
<div><p>Input array.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>chi2</strong> : float</p>
<blockquote class="last">
<div><p>Circular chi^2.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.calculate_svd">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">calculate_svd</code><span class="sig-paren">(</span><em>pp</em>, <em>r_0</em>, <em>beta</em>, <em>N_piercepoints</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.calculate_svd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns result (U) of svd for K-L vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pp</strong> : array</p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>r_0: float</strong></p>
<blockquote>
<div><p>Scale size of amp fluctuations (m)</p>
</div></blockquote>
<p><strong>beta: float</strong></p>
<blockquote>
<div><p>Power-law index for amp structure function (5/3 =&gt; pure Kolmogorov
turbulence)</p>
</div></blockquote>
<p><strong>N_piercepoints</strong> : int</p>
<blockquote>
<div><p>Number of piercepoints</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>C</strong> : array</p>
<blockquote>
<div><p>C matrix</p>
</div></blockquote>
<p><strong>pinvC</strong> : array</p>
<blockquote>
<div><p>Inv(C) matrix</p>
</div></blockquote>
<p><strong>U</strong> : array</p>
<blockquote class="last">
<div><p>Unitary matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.fit_screen">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">fit_screen</code><span class="sig-paren">(</span><em>station_names</em>, <em>source_names</em>, <em>full_matrices</em>, <em>pp</em>, <em>rr</em>, <em>weights</em>, <em>order</em>, <em>r_0</em>, <em>beta</em>, <em>screen_type</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.fit_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a screen to amplitudes or phases using Karhunen-Lo`eve base vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>station_names: array</strong></p>
<blockquote>
<div><p>Array of station names</p>
</div></blockquote>
<p><strong>source_names: array</strong></p>
<blockquote>
<div><p>Array of source names</p>
</div></blockquote>
<p><strong>full_matrices</strong> : list of arrays</p>
<blockquote>
<div><p>List of [C, pivC, U] matrices for all piercepoints</p>
</div></blockquote>
<p><strong>pp: array</strong></p>
<blockquote>
<div><p>Array of piercepoint locations</p>
</div></blockquote>
<p><strong>airmass: array</strong></p>
<blockquote>
<div><p>Array of airmass values (note: not currently used)</p>
</div></blockquote>
<p><strong>rr: array</strong></p>
<blockquote>
<div><p>Array of amp values to fit screen to</p>
</div></blockquote>
<p><strong>weights: array</strong></p>
<blockquote>
<div><p>Array of weights</p>
</div></blockquote>
<p><strong>order: int</strong></p>
<blockquote>
<div><p>Order of screen (i.e., number of KL base vectors to keep)</p>
</div></blockquote>
<p><strong>r_0: float</strong></p>
<blockquote>
<div><p>Scale size of amp fluctuations (m)</p>
</div></blockquote>
<p><strong>beta: float</strong></p>
<blockquote>
<div><p>Power-law index for amp structure function (5/3 =&gt; pure Kolmogorov
turbulence)</p>
</div></blockquote>
<p><strong>screen_type</strong> : str</p>
<blockquote>
<div><p>Type of screen: ‘phase’ or ‘amplitude’</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>screen_fit_white_all, screen_residual_all</strong> : array, array</p>
<blockquote class="last">
<div><p>Arrays of screen and residual (actual - screen) values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="losoto.operations.stationscreen.run">
<code class="descclassname">losoto.operations.stationscreen.</code><code class="descname">run</code><span class="sig-paren">(</span><em>soltab</em>, <em>outsoltab</em>, <em>order=12</em>, <em>beta=1.6666666666666667</em>, <em>ncpu=0</em>, <em>niter=2</em>, <em>nsigma=5.0</em>, <em>refAnt=-1</em>, <em>scale_order=True</em>, <em>scale_dist=None</em>, <em>min_order=5</em>, <em>adjust_order=True</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.stationscreen.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits station screens to input soltab (type ‘phase’ or ‘amplitude’ only).</p>
<p>The results of the fit are stored in the soltab parent solset in “outsoltab”
and the residual values (actual - screen) are stored in “outsoltabresid”.
These values are the screen amplitude values per station per pierce point
per solution interval. The pierce point locations are stored in an auxiliary
array in the output soltabs.</p>
<p>Screens can be plotted with the PLOTSCREEN operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>soltab: solution table</strong></p>
<blockquote>
<div><p>Soltab containing amplitude solutions</p>
</div></blockquote>
<p><strong>outsoltab: str</strong></p>
<blockquote>
<div><p>Name of output soltab</p>
</div></blockquote>
<p><strong>order</strong> : int, optional</p>
<blockquote>
<div><p>Order of screen (i.e., number of KL base vectors to keep). If the order
is scaled by dist (scale_order = True), the order is calculated as
order * sqrt(dist/scale_dist)</p>
</div></blockquote>
<p><strong>beta: float, optional</strong></p>
<blockquote>
<div><p>Power-law index for amp structure function (5/3 =&gt; pure Kolmogorov
turbulence)</p>
</div></blockquote>
<p><strong>ncpu: int, optional</strong></p>
<blockquote>
<div><p>Number of CPUs to use. If 0, all are used</p>
</div></blockquote>
<p><strong>niter: int, optional</strong></p>
<blockquote>
<div><p>Number of iterations to do when determining weights</p>
</div></blockquote>
<p><strong>nsigma: float, optional</strong></p>
<blockquote>
<div><p>Number of sigma above which directions are flagged</p>
</div></blockquote>
<p><strong>refAnt: str or int, optional</strong></p>
<blockquote>
<div><p>Index (if int) or name (if str) of reference station (-1 =&gt; no ref)</p>
</div></blockquote>
<p><strong>scale_order</strong> : bool, optional</p>
<blockquote>
<div><p>If True, scale the screen order with sqrt of distance/scale_dist to the
reference station</p>
</div></blockquote>
<p><strong>scale_dist</strong> : float, optional</p>
<blockquote>
<div><p>Distance used to normalize the distances used to scale the screen order.
If None, the max distance is used</p>
</div></blockquote>
<p><strong>adjust_order</strong> : bool, optional</p>
<blockquote>
<div><p>If True, adjust the screen order to obtain a reduced chi^2 of approx.
unity</p>
</div></blockquote>
<p><strong>min_order</strong> : int, optional</p>
<blockquote class="last">
<div><p>The minimum allowed order if adjust_order = True.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-losoto.operations.tecjump">
<span id="losoto-operations-tecjump-module"></span><h2>losoto.operations.tecjump module<a class="headerlink" href="#module-losoto.operations.tecjump" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="losoto.operations.tecjump.run">
<code class="descclassname">losoto.operations.tecjump.</code><code class="descname">run</code><span class="sig-paren">(</span><em>step</em>, <em>parset</em>, <em>H</em><span class="sig-paren">)</span><a class="headerlink" href="#losoto.operations.tecjump.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-losoto.operations">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-losoto.operations" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="losoto.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">losoto.operations package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-losoto.operations.abs">losoto.operations.abs module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.clip">losoto.operations.clip module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.clocktec">losoto.operations.clocktec module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.crossdelay">losoto.operations.crossdelay module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.duplicate">losoto.operations.duplicate module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.example">losoto.operations.example module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.faraday">losoto.operations.faraday module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.fitClockTEC">losoto.operations.fitClockTEC module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.flag">losoto.operations.flag module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.flagextend">losoto.operations.flagextend module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.interp">losoto.operations.interp module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.norm">losoto.operations.norm module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.plot">losoto.operations.plot module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.plotscreen">losoto.operations.plotscreen module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.reset">losoto.operations.reset module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.residuals">losoto.operations.residuals module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.reweight">losoto.operations.reweight module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.screenvalues">losoto.operations.screenvalues module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.smooth">losoto.operations.smooth module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.stationscreen">losoto.operations.stationscreen module</a></li>
<li><a class="reference internal" href="#module-losoto.operations.tecjump">losoto.operations.tecjump module</a></li>
<li><a class="reference internal" href="#module-losoto.operations">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="losoto.html"
                        title="previous chapter">losoto package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/losoto.operations.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="losoto.html" title="losoto package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="losoto.html">LoSoTo 2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Francesco de Gasperin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
  </body>
</html>